{"remainingRequest":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/thread-loader/dist/cjs.js!/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/babel-loader/lib/index.js!/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/userInfo/components/UpdateImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/userInfo/components/UpdateImg.vue","mtime":1632475418064},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy95YW5tYW9odWEvRGVza3RvcC90b3V0aWFvL3RvdXRpYW8vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCmltcG9ydCAnY3JvcHBlcmpzL2Rpc3QvY3JvcHBlci5jc3MnOwppbXBvcnQgQ3JvcHBlciBmcm9tICdjcm9wcGVyanMnOwpleHBvcnQgZGVmYXVsdCB7CiAgcHJvcHM6IHsKICAgIGltZzogewogICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgdHlwZTogW1N0cmluZywgT2JqZWN0XQogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGNyb3BwZXI6IG51bGwKICAgIH07CiAgfSwKICBtZXRob2RzOiB7CiAgICBjYW5jZWw6IGZ1bmN0aW9uIGNhbmNlbCgpIHt9LAogICAgc3ViOiBmdW5jdGlvbiBzdWIoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICB0aGlzLiR0b2FzdC5sb2FkaW5nKCfmraPlnKjkv53lrZgnKTsKICAgICAgdGhpcy5jcm9wcGVyLmdldENyb3BwZWRDYW52YXMoKS50b0Jsb2IoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIF9yZWYgPSBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoYmxvYikgewogICAgICAgICAgdmFyIGZvcm1kYXRhLCBfeWllbGQkX3RoaXMkJGF4aW9zJHAsIHJlczsKCiAgICAgICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICAgIGZvcm1kYXRhID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgICAgICAgICAgIGZvcm1kYXRhLmFwcGVuZCgncGhvdG8nLCBibG9iKTsKICAgICAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDI7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA1OwogICAgICAgICAgICAgICAgICByZXR1cm4gX3RoaXMuJGF4aW9zLnBhdGNoKCd2MV8wL3VzZXIvcGhvdG8nLCBmb3JtZGF0YSk7CgogICAgICAgICAgICAgICAgY2FzZSA1OgogICAgICAgICAgICAgICAgICBfeWllbGQkX3RoaXMkJGF4aW9zJHAgPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgICByZXMgPSBfeWllbGQkX3RoaXMkJGF4aW9zJHAuZGF0YTsKCiAgICAgICAgICAgICAgICAgIF90aGlzLiR0b2FzdC5zdWNjZXNzKCfkv53lrZjmiJDlip8nKTsKCiAgICAgICAgICAgICAgICAgIF90aGlzLiRlbWl0KCdjaGFuZ2VJbWcnLCByZXMucGhvdG8pOwoKICAgICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgICBjYXNlIDExOgogICAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTE7CiAgICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMik7CgogICAgICAgICAgICAgICAgICBfdGhpcy4kdG9hc3QuZmFpbCgn5L+d5a2Y5aSx6LSlJyk7CgogICAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzIsIDExXV0pOwogICAgICAgIH0pKTsKCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChfeCkgewogICAgICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgICB9OwogICAgICB9KCkpOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHsKICAgIHZhciBpbWFnZSA9IHRoaXMuJHJlZnMuaW1nOwogICAgdGhpcy5jcm9wcGVyID0gbmV3IENyb3BwZXIoaW1hZ2UsIHsKICAgICAgYXNwZWN0UmF0aW86IDEsCiAgICAgIHZpZXdNb2RlOiAxLAogICAgICBkcmFnTW9kZTogJ21vdmUnLAogICAgICBjcm9wQm94TW92YWJsZTogZmFsc2UsCiAgICAgIGNyb3BCb3hSZXNpemFibGU6IGZhbHNlLAogICAgICBiYWNrZ3JvdW5kOiBmYWxzZQogICAgfSk7CiAgfQp9Ow=="},{"version":3,"sources":["UpdateImg.vue"],"names":[],"mappings":";;;;;;;;;;;;AAWA,OAAA,4BAAA;AACA,OAAA,OAAA,MAAA,WAAA;AACA,eAAA;AACA,EAAA,KAAA,EAAA;AACA,IAAA,GAAA,EAAA;AACA,MAAA,QAAA,EAAA,IADA;AAEA,MAAA,IAAA,EAAA,CAAA,MAAA,EAAA,MAAA;AAFA;AADA,GADA;AAOA,EAAA,IAPA,kBAOA;AACA,WAAA;AACA,MAAA,OAAA,EAAA;AADA,KAAA;AAGA,GAXA;AAYA,EAAA,OAAA,EAAA;AACA,IAAA,MADA,oBACA,CAAA,CADA;AAEA,IAAA,GAFA,iBAEA;AAAA;;AACA,WAAA,MAAA,CAAA,OAAA,CAAA,MAAA;AACA,WAAA,OAAA,CAAA,gBAAA,GAAA,MAAA;AAAA,2EAAA,iBAAA,IAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AACA,kBAAA,QADA,GACA,IAAA,QAAA,EADA;AAEA,kBAAA,QAAA,CAAA,MAAA,CAAA,OAAA,EAAA,IAAA;AAFA;AAAA;AAAA,yBAIA,KAAA,CAAA,MAAA,CAAA,KAAA,CACA,iBADA,EAEA,QAFA,CAJA;;AAAA;AAAA;AAIA,kBAAA,GAJA,yBAIA,IAJA;;AAQA,kBAAA,KAAA,CAAA,MAAA,CAAA,OAAA,CAAA,MAAA;;AACA,kBAAA,KAAA,CAAA,KAAA,CAAA,WAAA,EAAA,GAAA,CAAA,KAAA;;AATA;AAAA;;AAAA;AAAA;AAAA;;AAWA,kBAAA,KAAA,CAAA,MAAA,CAAA,IAAA,CAAA,MAAA;;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAA;;AAAA;AAAA;AAAA;AAAA;AAcA;AAlBA,GAZA;AAgCA,EAAA,OAhCA,qBAgCA;AACA,QAAA,KAAA,GAAA,KAAA,KAAA,CAAA,GAAA;AACA,SAAA,OAAA,GAAA,IAAA,OAAA,CAAA,KAAA,EAAA;AACA,MAAA,WAAA,EAAA,CADA;AAEA,MAAA,QAAA,EAAA,CAFA;AAGA,MAAA,QAAA,EAAA,MAHA;AAIA,MAAA,cAAA,EAAA,KAJA;AAKA,MAAA,gBAAA,EAAA,KALA;AAMA,MAAA,UAAA,EAAA;AANA,KAAA,CAAA;AAQA;AA1CA,CAAA","sourcesContent":["<template>\n  <div class=\"bc\">\n    <img :src=\"img\" alt=\"\" ref=\"img\" />\n    <div class=\"toolBar\">\n      <div class=\"cancel\" @click=\"$emit('closeImg')\">取消</div>\n      <div class=\"ok\" @click=\"sub\">完成</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport 'cropperjs/dist/cropper.css'\nimport Cropper from 'cropperjs'\nexport default {\n  props: {\n    img: {\n      required: true,\n      type: [String, Object]\n    }\n  },\n  data() {\n    return {\n      cropper: null\n    }\n  },\n  methods: {\n    cancel() {},\n    sub() {\n      this.$toast.loading('正在保存')\n      this.cropper.getCroppedCanvas().toBlob(async (blob) => {\n        const formdata = new FormData()\n        formdata.append('photo', blob)\n        try {\n          const { data: res } = await this.$axios.patch(\n            'v1_0/user/photo',\n            formdata\n          )\n          this.$toast.success('保存成功')\n          this.$emit('changeImg', res.photo)\n        } catch (err) {\n          this.$toast.fail('保存失败')\n        }\n      })\n    }\n  },\n  mounted() {\n    const image = this.$refs.img\n    this.cropper = new Cropper(image, {\n      aspectRatio: 1,\n      viewMode: 1,\n      dragMode: 'move',\n      cropBoxMovable: false,\n      cropBoxResizable: false,\n      background: false\n    })\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.bc {\n  background-color: black;\n  height: 100%;\n  width: 100%;\n  img {\n    max-width: 100%;\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n  .toolBar {\n    position: fixed;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: space-between;\n    .ok,\n    .cancel {\n      padding: 10px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 60px;\n      height: 60px;\n      font-size: 30px;\n      color: white;\n    }\n  }\n}\n</style>\n"],"sourceRoot":"src/views/userInfo/components"}]}
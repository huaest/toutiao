{"remainingRequest":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/home/components/PopoUp.vue?vue&type=style&index=0&id=7cad5dc8&lang=less&scoped=true&","dependencies":[{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/home/components/PopoUp.vue","mtime":1632126128047},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmNoYW5uZWwtZWRpdCB7CiAgcGFkZGluZzogODVweCAwOwp9Ci5kZWxldGUtZWRpdCB7CiAgL2RlZXAvIC5ncmlkLWl0ZW0gewogICAgd2lkdGg6IDE2MHB4OwogICAgaGVpZ2h0OiA4NnB4OwogICAgLnZhbi1ncmlkLWl0ZW1fX2NvbnRlbnQgewogICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjRmNWY2OwogICAgICBmbGV4LWRpcmVjdGlvbjogcm93OwogICAgICBmb250LXNpemU6IDI4cHg7CiAgICAgIC52YW4tZ3JpZC1pdGVtX19pY29uLXdyYXBwZXIgewogICAgICAgIHBvc2l0aW9uOiB1bnNldDsKICAgICAgfQogICAgICAudmFuLWljb24tY2xlYXIgewogICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICByaWdodDogLTEwcHg7CiAgICAgICAgdG9wOiAtMTBweDsKICAgICAgICBmb250LXNpemU6IDMwcHg7CiAgICAgICAgei1pbmRleDogMjsKICAgICAgfQogICAgICAudmFuLWdyaWQtaXRlbV9fdGV4dCwKICAgICAgLnRleHQgewogICAgICAgIGZvbnQtc2l6ZTogMjVweDsKICAgICAgICBtYXJnaW4tdG9wOiAxMHB4OwogICAgICB9CiAgICB9CiAgfQp9Ci5jb21tZW5kLWVkaXQgewogIC9kZWVwLyAuZ3JpZC1pdGVtIHsKICAgIHdpZHRoOiAxNjBweDsKICAgIGhlaWdodDogODZweDsKICAgIC52YW4tZ3JpZC1pdGVtX19jb250ZW50IHsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2Y0ZjVmNjsKICAgICAgZmxleC1kaXJlY3Rpb246IHJvdzsKICAgICAgZm9udC1zaXplOiAyOHB4OwogICAgICAudmFuLWljb24gewogICAgICAgIGZvbnQtc2l6ZTogMjRweDsKICAgICAgfQogICAgICAudmFuLWdyaWQtaXRlbV9fdGV4dCB7CiAgICAgICAgbWFyZ2luLXRvcDogMTBweDsKICAgICAgfQogICAgfQogIH0KfQoKLmFjdGl2ZSB7CiAgY29sb3I6IHJlZDsKfQo="},{"version":3,"sources":["PopoUp.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4JA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"PopoUp.vue","sourceRoot":"src/views/home/components","sourcesContent":["<template>\n  <div class=\"channel-edit\">\n    <van-cell class=\"cell\">\n      <div slot=\"title\">我的频道</div>\n      <van-button type=\"primary\" size=\"mini\" round @click=\"edit\">{{\n        isEdit ? '完成' : '编辑'\n      }}</van-button>\n    </van-cell>\n    <van-grid :gutter=\"10\" class=\"delete-edit\">\n      <van-grid-item\n        class=\"grid-item\"\n        v-for=\"(value, index) in channels\"\n        :key=\"index\"\n        icon=\"clear\"\n        @click=\"changeChannel(value, index)\"\n      >\n        <van-icon\n          slot=\"icon\"\n          name=\"clear\"\n          v-show=\"isEdit && !fixChannels.includes(value.id)\"\n        ></van-icon>\n        <span slot=\"text\" class=\"text\" :class=\"{ active: index === active }\">{{\n          value.name\n        }}</span>\n      </van-grid-item>\n    </van-grid>\n    <!-- 频道推荐 -->\n    <van-cell class=\"cell\">\n      <div slot=\"title\">频道推荐</div>\n    </van-cell>\n    <van-grid :gutter=\"10\" class=\"commend-edit\">\n      <van-grid-item\n        class=\"grid-item\"\n        v-for=\"value in computeChannels\"\n        :key=\"value.id\"\n        :text=\"value.name\"\n        @click=\"addItem(value)\"\n      >\n        <van-icon slot=\"icon\" name=\"plus\" v-show=\"isEdit === true\"></van-icon>\n      </van-grid-item>\n    </van-grid>\n  </div>\n</template>\n\n<script>\nimport { setItem } from '@/utils/storage.js'\nimport { mapState } from 'vuex'\nexport default {\n  data() {\n    return {\n      allChannels: [],\n      isEdit: false,\n      fixChannels: [0]\n    }\n  },\n  props: {\n    channels: {\n      required: true,\n      type: Array\n    },\n    active: {\n      required: true,\n      type: Number\n    }\n  },\n  computed: {\n    ...mapState(['user']),\n    //   因为要时刻监听用户的选择，所以要用计算属性！！！\n    computeChannels() {\n      const newChannels = []\n      this.allChannels.forEach((channel) => {\n        //   找到符合条件的元素\n        const res = this.channels.find((my) => {\n          return my.id === channel.id\n        })\n        if (!res) {\n          newChannels.push(channel)\n        }\n      })\n      return newChannels\n    }\n  },\n  methods: {\n    //   所有频道请求模块\n    async getChannels() {\n      try {\n        const { data: res } = await this.$axios.get('v1_0/channels')\n        this.allChannels = res.data.channels\n      } catch (err) {\n        this.$toast.fail('获取列表失败')\n      }\n    },\n    async addItem(item) {\n      if (this.isEdit === true) {\n        this.channels.push(item)\n        if (this.user) {\n          try {\n            //   每添加一个发送请求\n            await this.$axios.patch('v1_0/user/channels', {\n              channels: [\n                {\n                  id: item.id,\n                  seq: this.channels.length\n                }\n              ]\n            })\n          } catch (err) {\n            this.$toast.fail('数据保存失败')\n          }\n        } else {\n          setItem('local-channel', this.channels)\n        }\n      }\n    },\n    edit() {\n      this.isEdit = !this.isEdit\n    },\n    // 只适用于父子组件传值！！\n    changeChannel(channel, index) {\n      if (!this.isEdit) {\n        this.$emit('channel-change', index, false)\n      } else {\n        //   固定不能删除的数据\n        if (this.fixChannels.includes(channel.id)) {\n          return\n        }\n        if (index <= this.active) {\n          this.$emit('channel-change', this.active - 1, true)\n        }\n        // 数组的删除操作，是对原数组的操作！！！\n        this.channels.splice(index, 1)\n        if (this.user) {\n          this.deleteChannel(channel)\n        } else {\n          setItem('local-channel', this.channels)\n        }\n      }\n    },\n    async deleteChannel(channel) {\n      if (this.user) {\n        try {\n          await this.$axios.delete(`v1_0/user/channels/${channel.id}`)\n        } catch (err) {\n          this.$toast.fail('数据存储失败')\n        }\n      } else {\n      }\n    }\n  },\n  created() {\n    this.getChannels()\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.channel-edit {\n  padding: 85px 0;\n}\n.delete-edit {\n  /deep/ .grid-item {\n    width: 160px;\n    height: 86px;\n    .van-grid-item__content {\n      white-space: nowrap;\n      background-color: #f4f5f6;\n      flex-direction: row;\n      font-size: 28px;\n      .van-grid-item__icon-wrapper {\n        position: unset;\n      }\n      .van-icon-clear {\n        position: absolute;\n        right: -10px;\n        top: -10px;\n        font-size: 30px;\n        z-index: 2;\n      }\n      .van-grid-item__text,\n      .text {\n        font-size: 25px;\n        margin-top: 10px;\n      }\n    }\n  }\n}\n.commend-edit {\n  /deep/ .grid-item {\n    width: 160px;\n    height: 86px;\n    .van-grid-item__content {\n      white-space: nowrap;\n      overflow: hidden;\n      background-color: #f4f5f6;\n      flex-direction: row;\n      font-size: 28px;\n      .van-icon {\n        font-size: 24px;\n      }\n      .van-grid-item__text {\n        margin-top: 10px;\n      }\n    }\n  }\n}\n\n.active {\n  color: red;\n}\n</style>\n"]}]}
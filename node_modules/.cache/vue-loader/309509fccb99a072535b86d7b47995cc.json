{"remainingRequest":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/userInfo/components/UpdateImg.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/userInfo/components/UpdateImg.vue","mtime":1632475418064},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAnY3JvcHBlcmpzL2Rpc3QvY3JvcHBlci5jc3MnCmltcG9ydCBDcm9wcGVyIGZyb20gJ2Nyb3BwZXJqcycKZXhwb3J0IGRlZmF1bHQgewogIHByb3BzOiB7CiAgICBpbWc6IHsKICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgIHR5cGU6IFtTdHJpbmcsIE9iamVjdF0KICAgIH0KICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjcm9wcGVyOiBudWxsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBjYW5jZWwoKSB7fSwKICAgIHN1YigpIHsKICAgICAgdGhpcy4kdG9hc3QubG9hZGluZygn5q2j5Zyo5L+d5a2YJykKICAgICAgdGhpcy5jcm9wcGVyLmdldENyb3BwZWRDYW52YXMoKS50b0Jsb2IoYXN5bmMgKGJsb2IpID0+IHsKICAgICAgICBjb25zdCBmb3JtZGF0YSA9IG5ldyBGb3JtRGF0YSgpCiAgICAgICAgZm9ybWRhdGEuYXBwZW5kKCdwaG90bycsIGJsb2IpCiAgICAgICAgdHJ5IHsKICAgICAgICAgIGNvbnN0IHsgZGF0YTogcmVzIH0gPSBhd2FpdCB0aGlzLiRheGlvcy5wYXRjaCgKICAgICAgICAgICAgJ3YxXzAvdXNlci9waG90bycsCiAgICAgICAgICAgIGZvcm1kYXRhCiAgICAgICAgICApCiAgICAgICAgICB0aGlzLiR0b2FzdC5zdWNjZXNzKCfkv53lrZjmiJDlip8nKQogICAgICAgICAgdGhpcy4kZW1pdCgnY2hhbmdlSW1nJywgcmVzLnBob3RvKQogICAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgICAgdGhpcy4kdG9hc3QuZmFpbCgn5L+d5a2Y5aSx6LSlJykKICAgICAgICB9CiAgICAgIH0pCiAgICB9CiAgfSwKICBtb3VudGVkKCkgewogICAgY29uc3QgaW1hZ2UgPSB0aGlzLiRyZWZzLmltZwogICAgdGhpcy5jcm9wcGVyID0gbmV3IENyb3BwZXIoaW1hZ2UsIHsKICAgICAgYXNwZWN0UmF0aW86IDEsCiAgICAgIHZpZXdNb2RlOiAxLAogICAgICBkcmFnTW9kZTogJ21vdmUnLAogICAgICBjcm9wQm94TW92YWJsZTogZmFsc2UsCiAgICAgIGNyb3BCb3hSZXNpemFibGU6IGZhbHNlLAogICAgICBiYWNrZ3JvdW5kOiBmYWxzZQogICAgfSkKICB9Cn0K"},{"version":3,"sources":["UpdateImg.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UpdateImg.vue","sourceRoot":"src/views/userInfo/components","sourcesContent":["<template>\n  <div class=\"bc\">\n    <img :src=\"img\" alt=\"\" ref=\"img\" />\n    <div class=\"toolBar\">\n      <div class=\"cancel\" @click=\"$emit('closeImg')\">取消</div>\n      <div class=\"ok\" @click=\"sub\">完成</div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport 'cropperjs/dist/cropper.css'\nimport Cropper from 'cropperjs'\nexport default {\n  props: {\n    img: {\n      required: true,\n      type: [String, Object]\n    }\n  },\n  data() {\n    return {\n      cropper: null\n    }\n  },\n  methods: {\n    cancel() {},\n    sub() {\n      this.$toast.loading('正在保存')\n      this.cropper.getCroppedCanvas().toBlob(async (blob) => {\n        const formdata = new FormData()\n        formdata.append('photo', blob)\n        try {\n          const { data: res } = await this.$axios.patch(\n            'v1_0/user/photo',\n            formdata\n          )\n          this.$toast.success('保存成功')\n          this.$emit('changeImg', res.photo)\n        } catch (err) {\n          this.$toast.fail('保存失败')\n        }\n      })\n    }\n  },\n  mounted() {\n    const image = this.$refs.img\n    this.cropper = new Cropper(image, {\n      aspectRatio: 1,\n      viewMode: 1,\n      dragMode: 'move',\n      cropBoxMovable: false,\n      cropBoxResizable: false,\n      background: false\n    })\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.bc {\n  background-color: black;\n  height: 100%;\n  width: 100%;\n  img {\n    max-width: 100%;\n    position: absolute;\n    top: 50%;\n    transform: translateY(-50%);\n  }\n  .toolBar {\n    position: fixed;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    justify-content: space-between;\n    .ok,\n    .cancel {\n      padding: 10px;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      width: 60px;\n      height: 60px;\n      font-size: 30px;\n      color: white;\n    }\n  }\n}\n</style>\n"]}]}
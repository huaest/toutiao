{"remainingRequest":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/home/components/ArticleList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/home/components/ArticleList.vue","mtime":1632121716085},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBcnRpY2xlSXRlbSBmcm9tICdAL2NvbXBvbmVudHMvQXJ0aWNsZUl0ZW0vaW5kZXgudnVlJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ0FydGljbGVMaXN0JywKICBwcm9wczogewogICAgY2hhbm5lbDogewogICAgICB0eXBlOiBPYmplY3QsCiAgICAgIHJlcXVpcmVkOiB0cnVlCiAgICB9CiAgfSwKICBjb21wb25lbnRzOiB7CiAgICBBcnRpY2xlSXRlbQogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIGxpc3Q6IFtdLAogICAgICBsb2FkaW5nOiBmYWxzZSwKICAgICAgZmluaXNoZWQ6IGZhbHNlLAogICAgICBjaGFubmVsX2lkOiB0aGlzLmNoYW5uZWwuaWQsCiAgICAgIHRpbWVzdGFtcDogdGhpcy50aW1lc3RhbXAgfHwgRGF0ZS5ub3coKSwKICAgICAgd2l0aF90b3A6IDEsCiAgICAgIGVycm9yOiBmYWxzZSwKICAgICAgaXNSZWZyZXNoaW5nOiBmYWxzZQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgLy8gb25Mb2FkKCkge30sCiAgICBhc3luYyBvbkxvYWQoKSB7CiAgICAgIHRyeSB7CiAgICAgICAgY29uc3QgeyBkYXRhOiByZXMgfSA9IGF3YWl0IHRoaXMuJGF4aW9zLmdldCgndjFfMS9hcnRpY2xlcycsIHsKICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICBjaGFubmVsX2lkOiB0aGlzLmNoYW5uZWwuaWQsCiAgICAgICAgICAgIHRpbWVzdGFtcDogdGhpcy50aW1lc3RhbXAsCiAgICAgICAgICAgIHdpdGhfdG9wOiB0aGlzLndpdGhfdG9wCiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICB0aGlzLmxpc3QucHVzaCguLi5yZXMuZGF0YS5yZXN1bHRzKQogICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlCiAgICAgICAgaWYgKHJlcy5kYXRhLnJlc3VsdHMubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHJlcy5kYXRhLnByZV90aW1lc3RhbXAKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgfQogICAgfSwKICAgIGFzeW5jIG9uUmVmcmVzaCgpIHsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCB7IGRhdGE6IHJlcyB9ID0gYXdhaXQgdGhpcy4kYXhpb3MuZ2V0KCd2MV8xL2FydGljbGVzJywgewogICAgICAgICAgcGFyYW1zOiB7CiAgICAgICAgICAgIGNoYW5uZWxfaWQ6IHRoaXMuY2hhbm5lbC5pZCwKICAgICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLAogICAgICAgICAgICB3aXRoX3RvcDogdGhpcy53aXRoX3RvcAogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgdGhpcy5saXN0LnVuc2hpZnQoLi4ucmVzLmRhdGEucmVzdWx0cykKICAgICAgICB0aGlzLmlzUmVmcmVzaGluZyA9IGZhbHNlCiAgICAgICAgaWYgKHJlcy5kYXRhLnJlc3VsdHMubGVuZ3RoKSB7CiAgICAgICAgICB0aGlzLnRpbWVzdGFtcCA9IHJlcy5kYXRhLnByZV90aW1lc3RhbXAKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5maW5pc2hlZCA9IHRydWUKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIHRoaXMuZXJyb3IgPSB0cnVlCiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgfQogICAgfQogIH0sCiAgY3JlYXRlZCgpIHt9Cn0K"},{"version":3,"sources":["ArticleList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArticleList.vue","sourceRoot":"src/views/home/components","sourcesContent":["<template>\n  <div class=\"articleList\">\n    <!-- pullfresh 要放在外面 -->\n    <van-pull-refresh\n      v-model=\"isRefreshing\"\n      @refresh=\"onRefresh\"\n      success-duration=\"500\"\n      success-text=\"刷新成功\"\n    >\n      <van-list\n        v-model=\"loading\"\n        :finished=\"finished\"\n        finished-text=\"没有更多了\"\n        :error.sync=\"error\"\n        error-text=\"请求失败，点击重新加载\"\n        @load=\"onLoad\"\n      >\n        <article-item\n          v-for=\"article in list\"\n          :key=\"article.art_id\"\n          :article=\"article\"\n        ></article-item>\n        <!-- <van-cell v-for=\"item in list\" :key=\"item.art_id\" :title=\"item.title\" /> -->\n      </van-list>\n    </van-pull-refresh>\n  </div>\n</template>\n\n<script>\nimport ArticleItem from '@/components/ArticleItem/index.vue'\nexport default {\n  name: 'ArticleList',\n  props: {\n    channel: {\n      type: Object,\n      required: true\n    }\n  },\n  components: {\n    ArticleItem\n  },\n  data() {\n    return {\n      list: [],\n      loading: false,\n      finished: false,\n      channel_id: this.channel.id,\n      timestamp: this.timestamp || Date.now(),\n      with_top: 1,\n      error: false,\n      isRefreshing: false\n    }\n  },\n  methods: {\n    // onLoad() {},\n    async onLoad() {\n      try {\n        const { data: res } = await this.$axios.get('v1_1/articles', {\n          params: {\n            channel_id: this.channel.id,\n            timestamp: this.timestamp,\n            with_top: this.with_top\n          }\n        })\n        this.list.push(...res.data.results)\n        this.loading = false\n        if (res.data.results.length) {\n          this.timestamp = res.data.pre_timestamp\n        } else {\n          this.finished = true\n        }\n      } catch (err) {\n        this.error = true\n        this.loading = false\n      }\n    },\n    async onRefresh() {\n      try {\n        const { data: res } = await this.$axios.get('v1_1/articles', {\n          params: {\n            channel_id: this.channel.id,\n            timestamp: Date.now(),\n            with_top: this.with_top\n          }\n        })\n        this.list.unshift(...res.data.results)\n        this.isRefreshing = false\n        if (res.data.results.length) {\n          this.timestamp = res.data.pre_timestamp\n        } else {\n          this.finished = true\n        }\n      } catch (err) {\n        this.error = true\n        this.loading = false\n      }\n    }\n  },\n  created() {}\n}\n</script>\n\n<style lang=\"less\" scoped>\n.articleList {\n  height: 79vh;\n  overflow-y: auto;\n}\n</style>\n"]}]}
{"remainingRequest":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/login/index.vue?vue&type=style&index=0&id=37dfd6fc&lang=less&scoped=true&","dependencies":[{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/src/views/login/index.vue","mtime":1631927031986},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/yanmaohua/Desktop/toutiao/toutiao/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmljb25mb250IHsKICBmb250LXNpemU6IDM3cHg7Cn0KLm1zZ0J0biB7CiAgd2lkdGg6IDE1NnB4OwogIGhlaWdodDogNDZweDsKICBsaW5lLWhlaWdodDogNDZweDsKICBjb2xvcjogIzY2NjsKfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n  <div>\n    <!-- 左箭头点击事件 -->\n    <van-nav-bar left-arrow title=\"登入\" @click-left=\"onClickLeft\" />\n    <!-- 表单 -->\n    <van-form @submit=\"onSubmit\" ref=\"loginForm\">\n      <van-field\n        name=\"mobile\"\n        placeholder=\"手机号\"\n        v-model=\"user.mobile\"\n        maxlength=\"11\"\n        type=\"number\"\n        :rules=\"userForm.mobile\"\n      >\n        <i slot=\"left-icon\" class=\"iconfont icon-shouji\"></i>\n      </van-field>\n      <van-field\n        type=\"password\"\n        name=\"code\"\n        placeholder=\"验证码\"\n        v-model=\"user.code\"\n        :rules=\"userForm.code\"\n      >\n        <i slot=\"left-icon\" class=\"iconfont icon-yanzhengma\"></i>\n        <template #button>\n          <!-- 倒计时 -->\n          <van-count-down\n            v-if=\"count\"\n            :time=\"time\"\n            @finish=\"closeC\"\n            format=\"ss\"\n          />\n\n          <!-- 这里要设置native-type 否则会触发表单验证 -->\n          <van-button\n            v-else\n            class=\"msgBtn\"\n            size=\"small\"\n            @click=\"getCode\"\n            native-type=\"button\"\n            >获取验证码</van-button\n          >\n        </template>\n      </van-field>\n      <div style=\"margin: 16px\">\n        <van-button block type=\"info\" native-type=\"submit\">提交</van-button>\n      </div>\n    </van-form>\n  </div>\n</template>\n\n<script>\n// import { login } from '@/api'\nexport default {\n  data() {\n    return {\n      user: {\n        mobile: '13911111112',\n        code: '246810'\n      },\n      userForm: {\n        mobile: [\n          { required: true, message: '请输入手机号', trigger: 'onBlur' }\n        ],\n        code: [{ required: true, message: '请输入验证码', trigger: 'onBlur' }]\n      },\n      count: false,\n      time: 1000 * 5\n    }\n  },\n  methods: {\n    // 验证码的finish事件\n    closeC() {\n      this.count = false\n    },\n    onClickLeft() {\n      // 哪里来哪里去\n      // this代表当前组件\n      this.$router.back()\n    },\n    // 获取验证码\n    async getCode() {\n      try {\n        await this.$refs.loginForm.validate('mobile')\n      } catch (err) {\n        return this.$toast.fail('请填写手机号')\n      }\n      this.count = true\n      try {\n        await this.$axios.get(`v1_0/sms/codes/${this.user.mobile}`)\n      } catch (err) {\n        // 关闭验证倒计时\n        this.count = false\n        // 提示频繁发送\n        if (err.response.status === 429) {\n          return this.$toast.fail('频繁发送')\n        }\n      }\n    },\n    // 表单提交发送请求\n    async onSubmit() {\n      // 加载提示ui\n      this.$toast.loading({\n        message: '加载中...',\n        forbidClick: true\n      })\n      const user = this.user\n      try {\n        const { data: res } = await this.$axios.post('/v1_0/authorizations', {\n          ...user\n        })\n        this.$toast.success('登入成功')\n        this.$store.commit('setUser', res.data)\n        this.$router.push('/')\n      } catch (err) {\n        this.$toast.fail('登入失败')\n      }\n    }\n  }\n}\n</script>\n\n<style lang=\"less\" scoped>\n.iconfont {\n  font-size: 37px;\n}\n.msgBtn {\n  width: 156px;\n  height: 46px;\n  line-height: 46px;\n  color: #666;\n}\n</style>\n"]}]}